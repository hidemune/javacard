カード型データベース　ヘルプ
大見出し	小見出し				
README	はじめに				ロ■ロ■ロ■ロ■ロ■ロ■ロ■ロ■ロ■ロ■ロ■ロ■ロ■ロ■ロ■ロ■ロ■ロ■	   	             　　Java版カード型データベース    Ver 2.0.0.6		ロ■ロ■ロ■ロ■ロ■ロ■ロ■ロ■ロ■ロ■ロ■ロ■ロ■ロ■ロ■ロ■ロ■ロ■				■はじめに	　　　　カード型データベースです。Javaで作成されておりWindowsとLinuxで	　　　　同じデータを管理することが可能です。データはタブ区切りのCSVで	　　　　保存されますのでメモ帳等で参照したり、ファイルをバックアップしたり	　　　　といった保守性も高いです。	　　　　抽出は2条件までのAND抽出のみとなっておりますのでご了承下さい。	　　　　自分はUSBメモリにインストールして、WindowsとLinuxの両方で	　　　　同じデータを持ち歩けるようにしています。	　　　　メール送信機能があり、カード１ページ分の内容を携帯やスマホに	　　　　転送して持ち歩くことができます。	　　　　データ全件を対象に、HTML自動生成及び、LibreOfficeとの連携により	　　　　PDF・Word文書等のドキュメント自動生成が可能で、画像の挿入にも	　　　　対応しています。ドキュメントジェネレータとして利用できます。	　　　　用途としてはソフトウェアの操作説明書作成などを想定していますが、	　　　　使い方次第でいろいろなドキュメントを作成可能です。	　　　　１つのリソースで、フレームを利用した参照しやすいHTML及び	　　　　印刷に適したPDF等のオフィス文書が作成可能なところが利点です。			■動作環境	　　　　Java 1.6 以上がインストールされている環境で使用できます。	　　　　LibreOffice文書の出力機能を使用する場合は、LibreOfficeがPCに	　　　　インストールされている必要があります。			■インストール、アンインストール	　　　　インストール先のフォルダへコピーするだけです。	　　　　アンインストール時にはファイルの削除を行なって下さい。	　　　　以下のファイル構成になっています。		「CardHELP」	・HTML形式のヘルプファイルです。このアプリで自動生成したものです。	　index.htmlをダブルクリックすればブラウザで見ることができます。	　また、メイン画面のヘルプメニューから「ヘルプ」を選択すれば	　ブラウザに表示されます。	　（対応していない環境では、このメニュー自体が表示されません。	　その場合は、Java 1.7以降にバージョンアップしてみてください。）		「image」	・メイン画面の大きなテキストエリアにドラッグ＆ドロップした	　画像ファイル（.bmp .png .gif .jpg .jpeg）が保存されます。		「lib」	・このアプリを実行する際に必要となるJavaのライブラリです。		「SampleSJIS」	・Shift-JIS形式のサンプルデータベースファイルです		「SampleUTF8」	・UTF-8形式のサンプルデータベースファイルです		「template」	・HTML及びLibreOfficeドキュメントの自動生成の際のテンプレートファイルです		「javacard.jar」	・アプリケーション本体です。	・NetBeansでコンパイルしたら、distフォルダからコピーしてきて配置してください。	・Windowsでは、これをダブルクリックすることで実行できます。		「card.properties」	・設定ファイルです。アプリ終了時に更新されます。	・起動の仕方にもよりますが、通常この場所のファイルはWindows用です。		「javacard.sh」	・Linux用の起動シェルスクリプトです。		「CardHELP.odt」	「CardHELP.pdf」	・このツールで出力したLibreOffice文書及びPDFのヘルプファイルです。	　ODTファイルを見るには、PCにLibreOfficeがインストールされている必要が	　あります。		「README.TXT」	・このファイルです。			■ヘルプファイルについて	　　　　\SampleUTF8\CardHELP.csv を、このツールで開けば	　　　　操作説明を見ることができます。	　　　　また、「CardHELP」フォルダにHTML形式のヘルプファイルがあります。	　　　　このアプリで自動生成したものです。	　　　　index.htmlをダブルクリックすればブラウザで見ることができます。	　　　　また、「CardHELP.odt」「CardHELP.pdf」というファイルもヘルプファイル	　　　　です。このアプリで自動生成したものです。			■再配布等について	　　　　再配布は自由です。	　　　　商用利用される場合はご連絡願います。			■おわりに	　　　　若い頃Delphiで作成したカード型データベースのJava移植版です。	　　　　これをUSBメモリにインストールして、自宅と会社の端末でOSを問わず	　　　　メモを持ち歩けるため、意外に重宝しています。		　　　　Ver 2.0.0.6 : CSS Frame版		　　　　Ver 2.0.0.5 : Frame版のHTML作成について、目次の入れ子構造に対応し	　　　　　　　　　　LibreOfficeの目次と見た目が同じになるようにした。	　　　　　　　　　　LibreOfficeの文書作成時に、見出しの番号付けをした場合	　　　　　　　　　　各レコード(CSVの行ごと)で１からになっていたのを修正	　　　　　　　　　　画像の挿入に対応した。エクスプローラからファイルを	　　　　　　　　　　ドラッグ＆ドロップすれば画像を追加できます。	　　　　　　　　　　このツール上では画像は表示されずファイル名のみですが	　　　　　　　　　　HTMLやLibreOffice文書を作成する際に画像が表示されます。	　　　　　　　　　　HTML作成のLegacyモードを廃止した。	　　　　　　　　　　メイン画面のヘルプメニューに「ヘルプ」を追加した。	　　　　　　　　　　（対応していない環境では表示されません）		　　　　Ver 2.0.0.4 : LibreOffice文書作成時に、目次の自動生成を可能にした。	　　　　　　　　　　画面左のリストボックスで「＋」「‐」キーを押すと行の順序を	　　　　　　　　　　変更できるようにした。	　　　　　　　　　　HTML作成について、フレームを利用しないLegacyモードと、	　　　　　　　　　　フレームを利用したFrameモードを選べるようにした。	　　　　　　　　　　画面右の大きなテキストエリアについて、編集した際、	　　　　　　　　　　画面タイトルに「* modified *」と表示されるようにした。		　　　　Ver 2.0.0.3 : メール送信機能を追加。	　　　　　　　　　　メモを印刷せずに携帯やスマホで持ち歩きたい時に便利です。	　　　　　　　　　　LibreOffice文書作成機能を追加。	　　　　　　　　　　この機能を利用するには、PCにLibreOfficeをインストールする	　　　　　　　　　　必要があります。LibreOfficeは無料のオフィスドキュメント作成	　　　　　　　　　　ツールです。		　　　　Ver 2.0.0.2 : ヘルプのバージョン表示の修正漏れに対応。	　　　　　　　　　　ファイル名を指定せずに参照ボタンを押した時に、	　　　　　　　　　　ホームディレクトリではなくカレントディレクトリを	　　　　　　　　　　表示するよう修正。	　　　　　　　　　　ファイル選択ダイアログでフォルダ名やファイル名の	　　　　　　　　　　修正モードに移行する機能を抑止するよう修正。	　　　　　　　　　　ファイル選択ダイアログでcsvファイルのみ表示するよう修正。	　　　　　　　　　　編集・表示各モードの大きなテキストエリアに右クリック機能を	　　　　　　　　　　追加。	　　　　　　　　　　右クリック機能追加に伴いヘルプ（\SampleUTF8\CardHELP.csv）	　　　　　　　　　　を修正。	　　　　　　　　　　HTML生成機能を追加。ファイル名から.CSVを除いた名前の	　　　　　　　　　　フォルダに作成する。	　　　　　　　　　　保存時に一回分だけバックアップを「○○.csv~」というファイル	　　　　　　　　　　名で保存するようにした。	　　　　　　　　　　ブラウザで表示可能なヘルプファイルを追加した。	　　　　　　　　　　テキストエリアにアンドゥ・リドゥ機能を追加した。		　　　　Ver 2.0.0.1 : Windows上で機種依存文字や全角ハイフンが文字化けするのを	　　　　　　　　　　修正。		　　　　Ver 2.0.0.0 : 2013.5.16制作。	　　　　Ver 1.0.0.0 : 2000年頃製作。		　　　　制作者　むうちょ　(e-mail  auau@kne.biglobe.ne.jp)		※おことわり	　　　　当作品の使用に際し、どのような不都合がありましても、当方では責任を一切	　　　　持ちませんので、自己の責任においてご使用ください。	　　　　また、バグが発生した場合、上記メールアドレスにご連絡くだされば幸い	　　　　ですが、必ずしも修正できるわけではありません。すみませんが、	　　　　ご了承ください。	
環境設定	画面レイアウト				&&IMAGE&&image/card_config.png
環境設定	ファイル名				データを保存するCSVファイルを指定します。	CSVファイルはタブ区切りのファイルとして作成されます。	１行目はデータベースタイトル	２行目は項目名（５つ）	３行目以降はデータベース本体となります。		タブで区切られたデータのうち、１‐５番目はそれぞれ項目名１‐５に割り当てられ、	６番目以降はデータ本文の大きなテキストエリアに表示されます。	データ本文の改行は、CSVにはタブ文字として保存されます。	データ本文にタブ文字が入力された場合、ファイルにはタブとして保存されますが	次に表示した際にはタブ文字は改行に変換されますので注意が必要です。		CSVから読み込んだ際に、データ本文のタブ文字は改行に変換されて	表示されます。	大きなテーブルのCSVファイルを加工してこのツールで読み込んだ場合	６番目以降のデータは全てデータ本文に項目毎に改行されて表示されます。		ファイル名を参照ボタンにより変更した場合、ファイルが存在する場合は	読み込みが行われます。		ファイル名を直接入力してEnterキーを押すことで	カレントディレクトリからの相対パスの入力も可能です。
環境設定	データベースタイトル				データベースタイトルを設定します。	CSVファイルの１行目に保存されます。
環境設定	項目名１‐５				項目名を５つまで設定できます。	項目名１は必須入力項目となっています。	項目名２以降は指定を省略できます。	CSVファイルの２行目にタブ区切りで保存されます。
環境設定	登録				CSVファイルの登録を行います。	データのヘッダ部分を更新し、	メモリ中にデータがある場合はデータ部分も保存されます。
ファイルメニュー	環境設定画面				環境設定画面を呼び出します。
ファイルメニュー	閉じる				アプリケーションを終了します。
表示メニュー	表示キー項目（左・右）				キー項目１‐５または本文を指定します。	ここで指定した項目が、Card画面左側のリストボックスに表示されます。
表示メニュー	検索条件（左・右）				前方一致検索か、部分一致検索を指定します。
メイン画面	画面レイアウト				&&IMAGE&&image/card_main.png
メイン画面	リストボックス				画面左のリストに表示メニューの表示キー項目で設定したものが	表示されます。リストは２つ左右に並んでおり、選択やスクロールが連動します。		その上のテキストフィールドに検索文字列を入力し	キーボードのEnterキーを押下することで検索を行うことができます。	表示メニューの検索条件で前方一致・部分一致を選択しておいて下さい。
メイン画面	表示・編集タブ				編集モードと表示モードの切り替えを行います。	表示モードを選択した場合は削除・登録を行うことはできません。
メイン画面	削除ボタン				リストで選択したデータをCSVファイルから１行削除します。	リストで一番上の空欄を選択した場合は削除できません。		表示モードではこの機能は使えません。
メイン画面	登録ボタン				編集中のデータをCSVファイルから１行登録します。	リストで一番上の空欄を選択した場合は新規に１行追加、	２番目以降を選択している場合はその行の変更を行います。		表示モードではこの機能は使えません。
メイン画面	スプリット（仕切り線）				画面のフィールドを区切る仕切り線は、マウスで幅を調節できます。	仕切り線の三角をクリックすることで幅を最小・最大に設定することもできます。	変更したサイズはアプリ終了時に保存され、	次回起動時に同じサイズで開始されます。
ヘルプ	バージョン情報				バージョン情報が表示されます。			【変更履歴】		Version 1.0.0.0	Delphiで作成。ソースが行方不明に。	作成は2000年頃		Version 2.0.0.0	NetBeans IDE 7.3 を使用してJavaで作成。	作成は2013年5月11日から16日まで	
環境設定・ファイルメニュー	新規作成				現在の設定内容を全てクリアし、新規に追加出来るようにします。
環境設定・ファイルメニュー	HTML作成(Frame)				データベースの内容からHTMLファイルを作成します。	フレームを利用したレイアウトです。		HTMLファイルは、CSVファイルと同じディレクトリに	ファイル名の「.csv」部分を消した名前でディレクトリが作成され、	その中に	image(フォルダ)	index.html	jcard.css	jcontents.html	jframe_top.html	page00000.html	page00001.html	page00002.html	・・・という形でファイルが作成されます。	index.html をダブルクリックしてブラウザで表示してください。		すでに同名のファイルやディレクトリが存在すると	エラーメッセージが表示され、HTMLファイルは作成されません。			templateフォルダ内のHTMLファイル、CSSファイルを編集することで	ブラウザ上での表現をカスタマイズできます。	これらのテンプレートファイルは、UTF-8で保存しておく必要が	あります。	
環境設定・ファイルメニュー	LibreOffice文書作成				LibreOffice Writer 文書をデータベースから作成することができます。	この機能を利用するためには、LibreOfficeがPCにインストールされて	いる必要があります。	Word文書やPDFも、LibreOfficeの機能で作成が可能です。	Word文書として保存する場合は、保存時に「フィルタ」から	Wordのバージョンを指定してください。	PDFとして保存する場合は、LibreOfficeのファイルメニューから	「PDFとしてエクスポート」を選択してください。		カレントディレクトリ（作業フォルダ）のtemplateディレクトリに	「template.odt」「createdocument.odt」という名前の	LibreOffice文書が置かれている必要があります。		また、プロパティファイルを編集して、LibreOfficeがインストールされた	フォルダ（実行形式ファイルのあるフォルダ）を指定する必要があります。		例）	LibreExePath=C\:\\Program Files (x86)\\LibreOffice 4.0\\program		この例のように「card.properties」ファイルを修正してください。	
環境設定・ファイルメニュー	メール送信設定				&&IMAGE&&image/card_mail.png	表示タブを選択している時に大きなテキストエリアを右クリックすると	「メール送信」機能が使えます。	メモを印刷せずに携帯やスマホなどで持ち歩きたい時に便利です。		この機能を使用するためには、PCがインターネットに接続	されている必要があります。	また、以下の項目をメール送信画面で設定しておく必要があります。		件名：メールの件名を設定しておきます。	Toメールアドレス：送信先アドレスを入力します。	Fromメールアドレス：送信元アドレスを入力します。	ホスト：通常、SMTPサーバを入れておけば良いかと思います。	SMTPホスト：SMTPサーバのアドレスを入力します。	ユーザー：メールのユーザー名を入力します。	パスワード：SMTPサーバにアクセスする際の認証用です。	
環境設定・文字コードメニュー	文字コードメニュー				CSVファイルの文字コードを指定します。		読み込み時、保存時とも、その都度指定文字コードを確認しますので、	UTF-8で読み込んだ後に設定を切り替えて	Shift-JISで保存することもできます。
設定ファイルについて	card.properties				設定ファイルについて、	Ver 2.0.0.2から画面で設定できない項目が存在します。	デフォルトの設定から変更したい場合は、カード型データベースアプリを終了した後	card.properties という名前のファイルをメモ帳などで開いて	以下のように修正し、保存してから再度アプリを起動しなおしてください。	Ver 2.0.0.3で項目追加となりました。以下をご確認ください。			★編集画面の大きなテキストエリアで右クリックすると	　日付や時刻が挿入できるようになりました。	　この時、デフォルトでは和暦で入力されますが、	　西暦に変更する場合は以下のようにします。		Seireki0Gengo1=0		　和暦に戻すときは		Seireki0Gengo1=1		　としてください。			★表示画面の大きなテキストエリアで右クリックすると	　メモ帳等のエディタに送ることができます（印刷を想定しています）。	　この時、デフォルトでは「notepad.exe」となっています。	　違うエディタを指定したい場合は以下の部分を修正します。		Editor=notepad.exe		　デフォルトではこうなっています。ここを		Editor=C\:\\Program Files\\Windows NT\\Accessories\\wordpad.exe		　この例のように修正してください。			★LibreOffice文書の自動生成機能が、環境設定画面のメニューに	　追加されました。	　この機能を利用するには、LibreOfficeがインストールされた	　フォルダを指定する必要があります。		LibreExePath=C\:\\Program Files (x86)\\LibreOffice 4.0\\program		　この例のように修正してください。
その他	Tips				テキストエリアのアンドゥ・リドゥ（元に戻す・やり直し）は	それぞれキーボードから「Ctrl-Z」「Ctrl-Y」です。		CSVを保存する際に、一回分だけバックアップを「○○.csv~」という	ファイル名で保存します。二度目の更新でバックアップは上書きされます。		画面左のリストボックスで「＋」「−」キーを押すと行の順序を変更できます。	変更後は、どの行でも良いので登録を行なってください。	この機能は、条件抽出を行なっていると使えません。		画面右の大きなテキストエリアを編集した時に、ウィンドウタイトルに	* modified *　と表示されますので、登録し忘れて他の行を選択してしまったり	画面を閉じてしまうなどしないように、必要に応じてご確認ください。
その他	画像取り込み操作手順				メイン画面の大きなテキストエリアに、エクスプローラから	画像ファイルをドラッグ＆ドロップしてください。	対応画像ファイルは「.bmp .gif .png .jpg .jpeg」です。	カレントディレクトリ（作業フォルダ）のimageディレクトリに、	「画像ファイル名.jpeg」 といった名前で画像が保存されます。		ドロップしたファイルが、テキストエリアのカーソルのある部分に	＆＆image＆＆ファイル名	のようなマークアップとして挿入されます。	注意点として、	必ず行頭・行末に、スペースを含む他の文字が入らないようにしてください。	でないと、HTMLやLibreOffice文書に、うまく画像が配置できません。		自動生成したドキュメントのサンプルとして、	・CardHELPフォルダのindex.html	・CardHELP.pdf	をご覧ください。	
